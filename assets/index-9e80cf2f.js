var F=(e,s,n)=>{if(!s.has(e))throw TypeError("Cannot "+n)};var t=(e,s,n)=>(F(e,s,"read from private field"),n?n.call(e):s.get(e)),o=(e,s,n)=>{if(s.has(e))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(e):s.set(e,n)},a=(e,s,n,i)=>(F(e,s,"write to private field"),i?i.call(e,n):s.set(e,n),n);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const b of l.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&i(b)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();var f,d,h;class W{constructor(){o(this,f,[]);o(this,d,[]);o(this,h,0)}add(s,n){t(this,f).splice(t(this,h),0,s),t(this,d).splice(t(this,h),0,n||s),a(this,h,t(this,h)+1)}ans(s){for(let n=0;n<t(this,f).length;n++)t(this,d)[n]==="ANS"&&(t(this,f)[n]=s)}clear(){a(this,f,[]),a(this,d,[]),a(this,h,0)}del(){t(this,f).length!==0&&t(this,h)!==t(this,f).length&&(t(this,f).splice(t(this,h),1),t(this,d).splice(t(this,h),1))}insert(s,n){t(this,f).splice(t(this,h),1,s),t(this,d).splice(t(this,h),1,n||s)}left(){t(this,h)>0&&a(this,h,t(this,h)-1)}right(){t(this,h)<t(this,f).length&&a(this,h,t(this,h)+1)}get cursor(){return t(this,h)}get length(){return t(this,f).length}toString(){let s=0,n=1,i=0,r=0,l=[...t(this,d),"&nbsp"];for(let P=0;P<t(this,d).length;P++){let D=t(this,d)[P],$=D==="&nbsp"?1:D.length;if(P<t(this,h)&&(i+=1),r+$<18)n+=1,r+=$;else if(i>0)s+=1,r-=l[s].length,n+=1,r+=$,i-=1;else if(i===0){n-=1;break}else i<0&&(s-=1,r+=l[s].length,n-=1,r-=$)}let b=l.slice(s,n),Q=b[i];return b[i]=`<span id='cursor'>${Q}</span>`,b.join("")}[Symbol.iterator](){let s=-1,n=t(this,f);return{next:()=>({value:n[++s],done:!(s in n)})}}}f=new WeakMap,d=new WeakMap,h=new WeakMap;var c,v;class X{constructor(s){o(this,c,void 0);o(this,v,0);a(this,c,[]);let n=[];for(let i of s)if(Y(i.toString()))n.push(i);else if(n.length>0){let r=parseFloat(n.join(""));n=[],t(this,c).push(r),t(this,c).push(i)}else t(this,c).push(i);if(n.length>0){let i=parseFloat(n.join(""));t(this,c).push(i)}t(this,c).push("END")}get current(){return t(this,c)[t(this,v)]}get next(){return t(this,c)[t(this,v)+1]}pop(){if(t(this,v)==t(this,c).length)throw"Reached end of buffer";let s=this.current;return a(this,v,t(this,v)+1),s}toString(){let s=[];for(let n=0;n<t(this,c).length;n++){let i=t(this,c)[n];n==t(this,v)&&(i="_"+i+"_"),s.push(i)}return"TokenBuffer[ '"+s.join("', '")+"' ]"}}c=new WeakMap,v=new WeakMap;function Y(e){return["0","1","2","3","4","5","6","7","8","9","."].includes(e)}function ee(e){if(typeof e!="number")throw`Type error: expected number, found ${e}`}function te(e){if(typeof e!="function"||e.length!==1)throw`Type error: expected function of length 1, found ${e}`}function ne(e){if(typeof e!="function"||e.length!==2)throw`Type error: expected function of length 2, found ${e}`}const M={log:Math.log10,tenPow:e=>10**e,ln:Math.log,ePow:e=>Math.E**e,pi:Math.PI,e:Math.E,"^":Math.pow,xrt:(e,s)=>s**(1/e),sqrt:Math.sqrt,squared:e=>e**2,sin:Math.sin,asin:Math.asin,cos:Math.cos,acos:Math.acos,tan:Math.tan,atan:Math.atan,inverted:e=>e**-1,E:(e,s)=>e*10**s,negate:e=>-e,"+":(e,s)=>e+s,"-":(e,s)=>e-s,"*":(e,s)=>e*s,"/":(e,s)=>e/s};var C;class H{constructor(...s){o(this,C,void 0);a(this,C,s)}eval(){throw"Superclass method not implemented"}toString(){return this.constructor.name+"("+t(this,C)+")"}}C=new WeakMap;var q,N,V;class O extends H{constructor(n,i,r){super(n,i,r);o(this,q,void 0);o(this,N,void 0);o(this,V,void 0);a(this,q,n),a(this,N,i),a(this,V,r)}eval(){let n=t(this,q).eval(),i=M[t(this,N)];ne(i);let r=t(this,V).eval();return i(n,r)}}q=new WeakMap,N=new WeakMap,V=new WeakMap;var x,I;class k extends H{constructor(n,i){super(n,i);o(this,x,void 0);o(this,I,void 0);a(this,x,n),a(this,I,i)}eval(){if(!M[t(this,x)])throw`Name ${t(this,x)} not found`;let n=M[t(this,x)];te(n);let i=t(this,I).eval();return n(i)}}x=new WeakMap,I=new WeakMap;var g;class se extends H{constructor(n){super(n);o(this,g,void 0);a(this,g,n)}eval(){if(typeof t(this,g)=="number")return t(this,g);{if(!M[t(this,g)])throw`Name ${t(this,g)} not found`;let n=M[t(this,g)];return ee(n),n}}}g=new WeakMap;const ie=["+","-"],re=["*","/",")E("],le=["^",")squared",")inverted"],ae=["negate"];function A(e){let s=R(e);for(;!L(e.current)&&ie.includes(e.current.toString());){let n=e.pop();if(typeof n=="number")throw"Incorrect type entered parser. This shouldn't happen.";let i=R(e);s=new O(s,n,i)}return s}function R(e){let s=_(e);for(;!L(e.current)&&re.includes(e.current.toString());){let n=e.pop();if(typeof n=="number")throw"Incorrect type entered factor. This shouldn't happen.";let i=_(e);s=new O(s,n,i)}return s}function _(e){let s=z(e);for(;!L(e.current)&&le.includes(e.current.toString());)if(J(e.current)){let n=e.pop();if(typeof n=="number")throw"Incorrect type entered exponent. This shouldn't happen.";s=new k(n,s)}else{let n=e.pop(),i=z(e);if(typeof n=="number")throw"Incorrect type entered exponent. This shouldn't happen.";s=new O(s,n,i)}return s}function z(e){if(!L(e.current)&&ae.includes(e.current.toString())){let s=e.pop(),n=G(e);if(typeof s=="number")throw"Incorrect type entered unary. This shouldn't happen.";return new k(s,n)}return oe(e)}function oe(e){let s=G(e);for(;!L(e.current)&&J(e.current);){let n=e.pop().toString().slice(1);if(j(n)){n=n.slice(0,-1);let i=A(e);s=new O(s,n,i)}else s=new k(n,s)}return s}function G(e){if(!L(e.current)&&j(e.current)){let s=e.pop().toString().slice(0,-1),n=A(e);return e.current===")"&&e.pop(),new k(s,n)}return ue(e)}function ue(e){let s;if(Z(e.current)||K(e.current))return new se(e.pop());if(e.current==="(")e.pop(),s=A(e),e.current.toString()===")"&&e.pop();else throw`Invalid literal ${e.current}`;return(Z(e.current)||K(e.current)||j(e.current)||e.current==="(")&&(s=new O(s,"*",_(e))),s}function L(e){return typeof e=="string"&&e==="END"}function Z(e){return typeof e=="number"}function K(e){return e?/^[a-zA-Z]+$/.test(e.toString()):!1}function j(e){return e?/^[a-zA-Z]+\($/.test(e.toString()):!1}function J(e){return e?/^\)[a-zA-Z]+\(?$/.test(e.toString()):!1}var E,u,S,y,p,m,T,w,B;class he{constructor(){o(this,E,0);o(this,u,new W);o(this,S,!1);o(this,y,!1);o(this,p,!1);o(this,m,document.querySelector("#input-screen"));o(this,T,document.querySelector("#output-screen"));o(this,w,!1);o(this,B,{equals:this.evaluate.bind(this),clear:(()=>{t(this,u).clear(),a(this,S,!1),t(this,y)?(t(this,T).textContent="",a(this,y,!1)):a(this,y,!0)}).bind(this),del:t(this,u).del.bind(t(this,u)),ins:()=>a(this,p,!t(this,p)),left:t(this,u).left.bind(t(this,u)),right:t(this,u).right.bind(t(this,u)),second:()=>a(this,w,!t(this,w))});t(this,m).innerHTML=t(this,u).toString()}evaluate(){if(t(this,u).length)try{t(this,u).ans(t(this,E));let s=new X(t(this,u)),n=A(s);a(this,E,n.eval()),t(this,T).textContent=this.trimOutput(t(this,E)),a(this,S,!0)}catch(s){console.log(s),t(this,T).textContent="ERROR",a(this,y,!0)}}keyHandler(s){let n=s.target;if(!(n instanceof HTMLButtonElement))return;let i,r;t(this,w)?(i=n.dataset.secondValue||n.id,r=n.dataset.secondBuffer||n.dataset.secondLabel||""):(i=n.id,r=n.dataset.buffer||n.textContent||""),t(this,S)&&i!=="second"&&(i in t(this,B)?a(this,S,!1):t(this,B).clear()),t(this,y)&&i!=="clear"&&a(this,y,!1),t(this,B).hasOwnProperty(i)?t(this,B)[i]():t(this,p)?(t(this,u).insert(i,r),a(this,p,!1)):(t(this,u).length===0&&["*","/","+","-","^",")xrt(",")squared",")inverted",")E("].includes(i)&&t(this,u).add("ANS","ANS"),t(this,u).add(i,r)),i!=="second"&&a(this,w,!1),t(this,w)?t(this,m).classList.add("second"):t(this,m).classList.remove("second"),t(this,p)&&["clear","del"].includes(i)&&a(this,p,!1),t(this,p)?t(this,m).classList.add("insert"):t(this,m).classList.remove("insert"),t(this,m).innerHTML=t(this,u).toString()}trimOutput(s){let n;return s.toString().length>18?n=s.toString().substring(0,17):n=s.toString(),n}}E=new WeakMap,u=new WeakMap,S=new WeakMap,y=new WeakMap,p=new WeakMap,m=new WeakMap,T=new WeakMap,w=new WeakMap,B=new WeakMap;const U={edit:[{label:"del",second:"ins"},{label:"<-",value:"left"},{label:"->",value:"right"}],left:[{label:"2nd",value:"second"},{label:"log",value:"log(",buffer:"log(",second:"10^",secondBuffer:"10^(",secondValue:"tenPow("},{label:"ln",value:"ln(",buffer:"ln(",second:"e^",secondBuffer:"e^(",secondValue:"ePow("},{label:"π",value:"pi",second:"e"},{label:"^",second:"ˣ√",secondValue:")xrt(",secondBuffer:"ˣ√("},{label:"x²",value:")squared",buffer:"²",second:"√",secondValue:"sqrt(",secondBuffer:"√("}],top:[{label:"sin",value:"sin(",buffer:"sin(",second:"sin⁻",secondValue:"asin(",secondBuffer:"sin⁻("},{label:"cos",value:"cos(",buffer:"cos(",second:"cos⁻",secondValue:"acos(",secondBuffer:"cos⁻("},{label:"tan",value:"tan(",buffer:"tan(",second:"tan⁻",secondValue:"atan(",secondBuffer:"tan⁻("},{label:"x⁻¹",value:")inverted",buffer:"⁻¹",second:"ᴇ",secondValue:")E("},{label:"("},{label:")"}],right:[{label:"clear"},{label:"/"},{label:"*"},{label:"﹣",value:"-"},{label:"+"},{label:"=",value:"equals"}],numbers:[{label:"7"},{label:"8"},{label:"9"},{label:"4"},{label:"5"},{label:"6"},{label:"1"},{label:"2"},{label:"3"},{label:"-",value:"negate",second:"ANS"},{label:"0"},{label:"."}]};function fe(e){function s(){const r=document.querySelector("#controls");for(let l in U)r.appendChild(n(l))}function n(r){const l=document.createElement("div");l.id=r;for(let b of U[r])l.appendChild(i(b));return l}function i(r){let l=document.createElement("button");return l.id=r.value?r.value:r.label,l.textContent=r.label,l.dataset.buffer=r.buffer?r.buffer:"",l.dataset.secondLabel=r.second?r.second:"",l.dataset.secondValue=r.secondValue?r.secondValue:r.second?r.second:r.value?r.value:r.label,l.dataset.secondBuffer=r.secondBuffer?r.secondBuffer:"",l.addEventListener("click",e.keyHandler.bind(e)),l}s()}const ce=new he;fe(ce);
